<!-- Only render actual input fields, skip parent containers -->
<div class="canvas-field" [ngClass]="getStatusClass()" *ngIf="!field.isParent">
    <mat-form-field
      appearance="outline"
      floatLabel="always"
      subscriptSizing="dynamic"
      class="md3-text-field"
      [class.has-error]="hasError"
      [class.is-disabled]="field.status === FieldStatus.EXTRACTING"
    >
      <mat-label>
        {{ getFieldLabel() }}
        <span *ngIf="field.isRequired" class="required-marker">*</span>
      </mat-label>

      <div
        class="selected-pill-row"
        *ngIf="field.multiple && field.value && field.value.length > 0"
      >
        <mat-chip-set class="chip-container inline" aria-label="Selected values">
          <mat-chip *ngFor="let item of field.value" highlighted (removed)="removeChip(item)">
            {{ getVocabularyLabel(item) }}
            <button matChipRemove type="button">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip>
        </mat-chip-set>
      </div>

      <textarea
        #textareaRef
        matInput
        rows="1"
        cdkTextareaAutosize
        cdkAutosizeMinRows="1"
        cdkAutosizeMaxRows="5"
        [(ngModel)]="inputValue"
        (input)="onInput($event)"
        (blur)="onBlur()"
        (focus)="onFocus(mainAutocomplete)"
        (keypress)="onKeyPress($event)"
        [disabled]="field.status === FieldStatus.EXTRACTING"
        [matAutocomplete]="auto"
        [attr.aria-describedby]="getSupportId(field.fieldId)"
        #mainAutocomplete="matAutocompleteTrigger"
      ></textarea>

      <button
        *ngIf="field.vocabulary"
        mat-icon-button
        matSuffix
        type="button"
        class="dropdown-trigger"
        (mousedown)="onDropdownMouseDown($event)"
        (click)="toggleAutocomplete(mainAutocomplete)"
        aria-label="Open options"
      >
        <mat-icon>arrow_drop_down</mat-icon>
      </button>

      <mat-icon
        matSuffix
        class="status-icon"
        [matTooltip]="getStatusTooltip(field.status)"
        [ngClass]="'status-' + field.status"
      >
        {{ getStatusIconName() }}
      </mat-icon>

      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selectOption($event.option.value)">
        <mat-option *ngFor="let option of filteredOptions" [value]="option">
          {{ option }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- Support text below field -->
    <div class="support-text" *ngIf="supportText && !hasError" [id]="getSupportId(field.fieldId)">
      {{ supportText }}
    </div>

    <!-- Error text below field -->
    <div class="error-text" *ngIf="hasError">
      {{ errorText }}
    </div>

    <div class="field-actions" *ngIf="hasGeoCoordinates()">
      <button
        mat-icon-button
        class="geo-button"
        [matTooltip]="'FIELD.SHOW_ON_MAP' | translate"
        (click)="openInOpenStreetMap()"
        type="button"
      >
        <mat-icon>map</mat-icon>
      </button>
    </div>
</div>
